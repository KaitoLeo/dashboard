<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Real-time Dashboard - Actiwell</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <style>
      .metric-card {
        transition: all 0.3s ease;
        border-left: 4px solid #007bff;
        margin-bottom: 1rem;
      }
      .metric-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }
      .metric-value {
        font-size: 1.5rem;
        font-weight: bold;
      }
      .metric-label {
        font-size: 0.9rem;
        color: #6c757d;
      }
      .real-time-indicator {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background-color: #28a745;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }
      .update-time {
        font-size: 0.8rem;
        color: #6c757d;
        text-align: center;
        margin-top: 10px;
      }
      .status-indicator {
        display: inline-block;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        margin-right: 5px;
      }
      .status-online {
        background-color: #28a745;
      }
      .status-offline {
        background-color: #dc3545;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1rem;
        margin-bottom: 2rem;
      }
      .category-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 1.5rem;
      }
      .control-panel {
        background: #f8f9fa;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 2rem;
      }
    </style>
  </head>
  <body>
    <div class="container-fluid">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div
              class="card-header bg-primary text-white d-flex justify-content-between align-items-center"
            >
              <div>
                <h4 class="mb-0">
                  <i class="fas fa-sync-alt me-2"></i>
                  Real-time Dashboard - C·∫≠p nh·∫≠t th·ªùi gian th·ª±c
                </h4>
                <p class="mb-0 mt-2">
                  T·∫•t c·∫£ metrics ƒë∆∞·ª£c c·∫≠p nh·∫≠t t·ª± ƒë·ªông m·ªói 30 gi√¢y
                </p>
              </div>
              <div class="text-end">
                <div class="d-flex align-items-center mb-2">
                  <span
                    class="status-indicator status-online"
                    id="statusIndicator"
                  ></span>
                  <span id="statusText">ƒêang k·∫øt n·ªëi...</span>
                </div>
                <div class="update-time" id="lastUpdateTime">
                  L·∫ßn c·∫≠p nh·∫≠t cu·ªëi: --
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Control Panel -->
      <div class="control-panel">
        <div class="row align-items-center">
          <div class="col-md-6">
            <h6 class="mb-0">
              <i class="fas fa-cog me-2"></i>
              ƒêi·ªÅu khi·ªÉn Real-time
            </h6>
          </div>
          <div class="col-md-6 text-end">
            <button
              class="btn btn-success me-2"
              id="startBtn"
              onclick="startRealTimeUpdates()"
            >
              <i class="fas fa-play me-1"></i> B·∫Øt ƒë·∫ßu
            </button>
            <button
              class="btn btn-danger me-2"
              id="stopBtn"
              onclick="stopRealTimeUpdates()"
              disabled
            >
              <i class="fas fa-stop me-1"></i> D·ª´ng
            </button>
            <button
              class="btn btn-info"
              id="refreshBtn"
              onclick="manualRefresh()"
            >
              <i class="fas fa-refresh me-1"></i> L√†m m·ªõi
            </button>
          </div>
        </div>
        <div class="row mt-2">
          <div class="col-md-6">
            <label for="updateInterval" class="form-label"
              >T·∫ßn su·∫•t c·∫≠p nh·∫≠t (gi√¢y):</label
            >
            <select
              class="form-select form-select-sm"
              id="updateInterval"
              onchange="changeUpdateInterval()"
            >
              <option value="10000">10 gi√¢y</option>
              <option value="30000" selected>30 gi√¢y</option>
              <option value="60000">1 ph√∫t</option>
              <option value="300000">5 ph√∫t</option>
            </select>
          </div>
          <div class="col-md-6">
            <div class="d-flex align-items-center">
              <span class="me-2">Tr·∫°ng th√°i:</span>
              <span id="statusDetails" class="badge bg-secondary"
                >Ch∆∞a kh·ªüi ƒë·ªông</span
              >
            </div>
          </div>
        </div>
      </div>

      <!-- 1. VISITOR & CONVERSION STATISTICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-users me-2"></i>1. Visitor & Conversion Statistics
          <span class="real-time-indicator"></span>
        </h5>
        <small
          >Th·ªëng k√™ kh√°ch tham quan v√† chuy·ªÉn ƒë·ªïi - C·∫≠p nh·∫≠t real-time</small
        >
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-exchange-alt fa-2x text-primary mb-2"></i>
            <h6>Visitor Conversion Rate</h6>
            <div class="metric-value text-primary" id="visitorConversionRate">
              15.2%
            </div>
            <div class="metric-label">T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi kh√°ch tham quan</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-redo fa-2x text-success mb-2"></i>
            <h6>Visitor Retention Rate</h6>
            <div class="metric-value text-success" id="visitorRetentionRate">
              68.5%
            </div>
            <div class="metric-label">T·ª∑ l·ªá gi·ªØ ch√¢n kh√°ch tham quan</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-bullseye fa-2x text-info mb-2"></i>
            <h6>Source Effectiveness Rate</h6>
            <div class="metric-value text-info" id="sourceEffectivenessRate">
              22.3%
            </div>
            <div class="metric-label">Hi·ªáu qu·∫£ ngu·ªìn kh√°ch h√†ng</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-line fa-2x text-warning mb-2"></i>
            <h6>Source ROI</h6>
            <div class="metric-value text-warning" id="sourceROI">185.7%</div>
            <div class="metric-label">ROI theo ngu·ªìn</div>
          </div>
        </div>
      </div>

      <!-- 2. SALES & CONVERSION METRICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-handshake me-2"></i>2. Sales & Conversion Metrics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Th·ªëng k√™ b√°n h√†ng v√† chuy·ªÉn ƒë·ªïi - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-user-tie fa-2x text-primary mb-2"></i>
            <h6>Sale Ti·∫øp Rate</h6>
            <div class="metric-value text-primary" id="saleTiepRate">78.5%</div>
            <div class="metric-label">T·ª∑ l·ªá PT ti·∫øp</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-weight fa-2x text-success mb-2"></i>
            <h6>Inbody Measurement Rate</h6>
            <div class="metric-value text-success" id="inbodyMeasurementRate">
              45.2%
            </div>
            <div class="metric-label">T·ª∑ l·ªá ƒëo Inbody</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-pie fa-2x text-info mb-2"></i>
            <h6>PT Conversion Rate</h6>
            <div class="metric-value text-info" id="ptConversionRate">
              78.5%
            </div>
            <div class="metric-label">T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi PT</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-percentage fa-2x text-warning mb-2"></i>
            <h6>Inbody Conversion Rate</h6>
            <div class="metric-value text-warning" id="inbodyConversionRate">
              57.6%
            </div>
            <div class="metric-label">T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi Inbody</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-clock fa-2x text-danger mb-2"></i>
            <h6>Average Sales Cycle</h6>
            <div class="metric-value text-danger" id="averageSalesCycle">
              12.5 ng√†y
            </div>
            <div class="metric-label">
              Th·ªùi gian trung b√¨nh t·ª´ lead ƒë·∫øn sale
            </div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-tachometer-alt fa-2x text-purple mb-2"></i>
            <h6>Sales Velocity</h6>
            <div class="metric-value text-purple" id="salesVelocity">
              2,450,000 VNƒê/ng√†y
            </div>
            <div class="metric-label">T·ªëc ƒë·ªô b√°n h√†ng</div>
          </div>
        </div>
      </div>

      <!-- 3. FACILITY & CAPACITY METRICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-building me-2"></i>3. Facility & Capacity Metrics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Th·ªëng k√™ c∆° s·ªü v·∫≠t ch·∫•t v√† nƒÉng l·ª±c - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-ruler fa-2x text-primary mb-2"></i>
            <h6>Floor Space Utilization</h6>
            <div class="metric-value text-primary" id="floorSpaceUtilization">
              82.3%
            </div>
            <div class="metric-label">T·ª∑ l·ªá s·ª≠ d·ª•ng kh√¥ng gian</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-dumbbell fa-2x text-success mb-2"></i>
            <h6>Equipment Utilization Rate</h6>
            <div
              class="metric-value text-success"
              id="equipmentUtilizationRate"
            >
              75.8%
            </div>
            <div class="metric-label">T·ª∑ l·ªá s·ª≠ d·ª•ng thi·∫øt b·ªã</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-lock fa-2x text-info mb-2"></i>
            <h6>Locker Utilization</h6>
            <div class="metric-value text-info" id="lockerUtilization">
              68.2%
            </div>
            <div class="metric-label">T·ª∑ l·ªá s·ª≠ d·ª•ng t·ªß ƒë·ªì</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-bar fa-2x text-warning mb-2"></i>
            <h6>Peak Hour Revenue Concentration</h6>
            <div
              class="metric-value text-warning"
              id="peakHourRevenueConcentration"
            >
              45.7%
            </div>
            <div class="metric-label">T·∫≠p trung doanh thu gi·ªù cao ƒëi·ªÉm</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-clock fa-2x text-danger mb-2"></i>
            <h6>Off-Peak Utilization</h6>
            <div class="metric-value text-danger" id="offPeakUtilization">
              35.4%
            </div>
            <div class="metric-label">S·ª≠ d·ª•ng gi·ªù th·∫•p ƒëi·ªÉm</div>
          </div>
        </div>
      </div>

      <!-- 4. MEMBER ANALYTICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-user-friends me-2"></i>4. Member Analytics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Ph√¢n t√≠ch h·ªôi vi√™n - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-running fa-2x text-primary mb-2"></i>
            <h6>Member Activity Score</h6>
            <div class="metric-value text-primary" id="memberActivityScore">
              2,145 ƒëi·ªÉm
            </div>
            <div class="metric-label">ƒêi·ªÉm ho·∫°t ƒë·ªông h·ªôi vi√™n</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-heart fa-2x text-success mb-2"></i>
            <h6>Member Engagement Level</h6>
            <div class="metric-value text-success" id="memberEngagementLevel">
              78.5%
            </div>
            <div class="metric-label">M·ª©c ƒë·ªô t∆∞∆°ng t√°c</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-dollar-sign fa-2x text-info mb-2"></i>
            <h6>Member Acquisition Cost by Channel</h6>
            <div
              class="metric-value text-info"
              id="memberAcquisitionCostByChannel"
            >
              850,000 VNƒê
            </div>
            <div class="metric-label">CAC theo k√™nh</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-gem fa-2x text-warning mb-2"></i>
            <h6>Member Lifetime Value by Segment</h6>
            <div
              class="metric-value text-warning"
              id="memberLifetimeValueBySegment"
            >
              18,500,000 VNƒê
            </div>
            <div class="metric-label">MLV theo ph√¢n kh√∫c</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-exclamation-triangle fa-2x text-danger mb-2"></i>
            <h6>Member Churn Prediction Score</h6>
            <div
              class="metric-value text-danger"
              id="memberChurnPredictionScore"
            >
              0.35
            </div>
            <div class="metric-label">ƒêi·ªÉm d·ª± ƒëo√°n r·ªùi b·ªè</div>
          </div>
        </div>
      </div>

      <!-- 5. FINANCIAL ANALYTICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-chart-line me-2"></i>5. Financial Analytics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Ph√¢n t√≠ch t√†i ch√≠nh - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-ruler-combined fa-2x text-primary mb-2"></i>
            <h6>Revenue per Square Foot</h6>
            <div class="metric-value text-primary" id="revenuePerSquareFoot">
              3,750,000 VNƒê/m¬≤
            </div>
            <div class="metric-label">Doanh thu tr√™n m·ªói m√©t vu√¥ng</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-pie fa-2x text-success mb-2"></i>
            <h6>Revenue Concentration Index</h6>
            <div
              class="metric-value text-success"
              id="revenueConcentrationIndex"
            >
              65.2%
            </div>
            <div class="metric-label">Ch·ªâ s·ªë t·∫≠p trung doanh thu</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-rocket fa-2x text-info mb-2"></i>
            <h6>Revenue Growth Acceleration</h6>
            <div class="metric-value text-info" id="revenueGrowthAcceleration">
              15.8%
            </div>
            <div class="metric-label">Gia t·ªëc tƒÉng tr∆∞·ªüng doanh thu</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-bullseye fa-2x text-warning mb-2"></i>
            <h6>Cost per Acquisition by Source</h6>
            <div
              class="metric-value text-warning"
              id="costPerAcquisitionBySource"
            >
              1,250,000 VNƒê
            </div>
            <div class="metric-label">Chi ph√≠ thu h√∫t theo ngu·ªìn</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-cogs fa-2x text-danger mb-2"></i>
            <h6>Operational Cost Ratio</h6>
            <div class="metric-value text-danger" id="operationalCostRatio">
              35.7%
            </div>
            <div class="metric-label">T·ª∑ l·ªá chi ph√≠ v·∫≠n h√†nh</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-line fa-2x text-purple mb-2"></i>
            <h6>Profit Margin by Service</h6>
            <div class="metric-value text-purple" id="profitMarginByService">
              42.3%
            </div>
            <div class="metric-label">Bi√™n l·ª£i nhu·∫≠n theo d·ªãch v·ª•</div>
          </div>
        </div>
      </div>

      <!-- 6. PERFORMANCE METRICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-trophy me-2"></i>6. Performance Metrics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Th·ªëng k√™ hi·ªáu su·∫•t - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-users-cog fa-2x text-primary mb-2"></i>
            <h6>Staff Productivity Index</h6>
            <div class="metric-value text-primary" id="staffProductivityIndex">
              125.7
            </div>
            <div class="metric-label">Ch·ªâ s·ªë nƒÉng su·∫•t nh√¢n vi√™n</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-clock fa-2x text-success mb-2"></i>
            <h6>Staff Revenue per Hour</h6>
            <div class="metric-value text-success" id="staffRevenuePerHour">
              450,000 VNƒê/gi·ªù
            </div>
            <div class="metric-label">Doanh thu/gi·ªù c·ªßa nh√¢n vi√™n</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-efficiency fa-2x text-info mb-2"></i>
            <h6>Staff Utilization Efficiency</h6>
            <div class="metric-value text-info" id="staffUtilizationEfficiency">
              88.5%
            </div>
            <div class="metric-label">Hi·ªáu qu·∫£ s·ª≠ d·ª•ng nh√¢n vi√™n</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-smile fa-2x text-warning mb-2"></i>
            <h6>Service Satisfaction Score</h6>
            <div
              class="metric-value text-warning"
              id="serviceSatisfactionScore"
            >
              4.2/5.0
            </div>
            <div class="metric-label">ƒêi·ªÉm h√†i l√≤ng d·ªãch v·ª•</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-check-circle fa-2x text-danger mb-2"></i>
            <h6>Service Completion Rate</h6>
            <div class="metric-value text-danger" id="serviceCompletionRate">
              92.3%
            </div>
            <div class="metric-label">T·ª∑ l·ªá ho√†n th√†nh d·ªãch v·ª•</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-star fa-2x text-purple mb-2"></i>
            <h6>Service Quality Index</h6>
            <div class="metric-value text-purple" id="serviceQualityIndex">
              89.7
            </div>
            <div class="metric-label">Ch·ªâ s·ªë ch·∫•t l∆∞·ª£ng d·ªãch v·ª•</div>
          </div>
        </div>
      </div>

      <!-- 7. DIGITAL ANALYTICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-digital-tachograph me-2"></i>7. Digital Analytics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Ph√¢n t√≠ch s·ªë - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-globe fa-2x text-primary mb-2"></i>
            <h6>Website Conversion Rate</h6>
            <div class="metric-value text-primary" id="websiteConversionRate">
              3.2%
            </div>
            <div class="metric-label">T·ª∑ l·ªá chuy·ªÉn ƒë·ªïi website</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-share-alt fa-2x text-success mb-2"></i>
            <h6>Social Media Engagement Rate</h6>
            <div
              class="metric-value text-success"
              id="socialMediaEngagementRate"
            >
              4.8%
            </div>
            <div class="metric-label">T·ª∑ l·ªá t∆∞∆°ng t√°c m·∫°ng x√£ h·ªôi</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-line fa-2x text-info mb-2"></i>
            <h6>Digital Marketing ROI</h6>
            <div class="metric-value text-info" id="digitalMarketingROI">
              285.4%
            </div>
            <div class="metric-label">ROI marketing s·ªë</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-mobile-alt fa-2x text-warning mb-2"></i>
            <h6>App Usage Frequency</h6>
            <div class="metric-value text-warning" id="appUsageFrequency">
              2.8 l·∫ßn/ng√†y
            </div>
            <div class="metric-label">T·∫ßn su·∫•t s·ª≠ d·ª•ng app</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-cogs fa-2x text-danger mb-2"></i>
            <h6>App Feature Utilization</h6>
            <div class="metric-value text-danger" id="appFeatureUtilization">
              67.3%
            </div>
            <div class="metric-label">S·ª≠ d·ª•ng t√≠nh nƒÉng app</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-redo fa-2x text-purple mb-2"></i>
            <h6>App Retention Rate</h6>
            <div class="metric-value text-purple" id="appRetentionRate">
              78.9%
            </div>
            <div class="metric-label">T·ª∑ l·ªá gi·ªØ ch√¢n app</div>
          </div>
        </div>
      </div>

      <!-- 8. PREDICTIVE ANALYTICS -->
      <div class="category-header">
        <h5 class="mb-0">
          <i class="fas fa-crystal-ball me-2"></i>8. Predictive Analytics
          <span class="real-time-indicator"></span>
        </h5>
        <small>Ph√¢n t√≠ch d·ª± ƒëo√°n - C·∫≠p nh·∫≠t real-time</small>
      </div>
      <div class="stats-grid">
        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-line fa-2x text-primary mb-2"></i>
            <h6>Demand Forecasting</h6>
            <div class="metric-value text-primary" id="demandForecasting">
              1,250 l∆∞·ª£t
            </div>
            <div class="metric-label">D·ª± b√°o nhu c·∫ßu</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-dollar-sign fa-2x text-success mb-2"></i>
            <h6>Revenue Forecasting</h6>
            <div class="metric-value text-success" id="revenueForecasting">
              4,200,000,000 VNƒê
            </div>
            <div class="metric-label">D·ª± b√°o doanh thu</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-building fa-2x text-info mb-2"></i>
            <h6>Capacity Planning</h6>
            <div class="metric-value text-info" id="capacityPlanning">
              1,850 ch·ªó
            </div>
            <div class="metric-label">L·∫≠p k·∫ø ho·∫°ch nƒÉng l·ª±c</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-exclamation-triangle fa-2x text-warning mb-2"></i>
            <h6>Churn Risk Score</h6>
            <div class="metric-value text-warning" id="churnRiskScore">
              0.42
            </div>
            <div class="metric-label">ƒêi·ªÉm r·ªßi ro r·ªùi b·ªè</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-chart-bar fa-2x text-danger mb-2"></i>
            <h6>Revenue Risk Assessment</h6>
            <div class="metric-value text-danger" id="revenueRiskAssessment">
              12.5%
            </div>
            <div class="metric-label">ƒê√°nh gi√° r·ªßi ro doanh thu</div>
          </div>
        </div>

        <div class="card metric-card">
          <div class="card-body text-center">
            <i class="fas fa-shield-alt fa-2x text-purple mb-2"></i>
            <h6>Operational Risk Index</h6>
            <div class="metric-value text-purple" id="operationalRiskIndex">
              8.7%
            </div>
            <div class="metric-label">Ch·ªâ s·ªë r·ªßi ro v·∫≠n h√†nh</div>
          </div>
        </div>
      </div>

      <!-- Summary -->
      <div class="row mt-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-success text-white">
              <h5 class="mb-0">
                <i class="fas fa-check-circle me-2"></i>
                Real-time Dashboard Status
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-3">
                  <h6 class="text-success">‚úÖ Real-time Features</h6>
                  <ul class="list-unstyled">
                    <li>‚Ä¢ Auto-update m·ªói 30 gi√¢y</li>
                    <li>‚Ä¢ Live data simulation</li>
                    <li>‚Ä¢ Visual indicators</li>
                    <li>‚Ä¢ Status monitoring</li>
                    <li>‚Ä¢ Manual refresh</li>
                  </ul>
                </div>
                <div class="col-md-3">
                  <h6 class="text-info">üìä Metrics Coverage</h6>
                  <ul class="list-unstyled">
                    <li>‚Ä¢ 8 nh√≥m ch√≠nh</li>
                    <li>‚Ä¢ 50+ c√¥ng th·ª©c</li>
                    <li>‚Ä¢ Real-time calculation</li>
                    <li>‚Ä¢ Auto-update UI</li>
                    <li>‚Ä¢ Performance optimized</li>
                  </ul>
                </div>
                <div class="col-md-3">
                  <h6 class="text-warning">üîß Controls</h6>
                  <ul class="list-unstyled">
                    <li>‚Ä¢ Start/Stop updates</li>
                    <li>‚Ä¢ Adjust intervals</li>
                    <li>‚Ä¢ Manual refresh</li>
                    <li>‚Ä¢ Status indicators</li>
                    <li>‚Ä¢ Error handling</li>
                  </ul>
                </div>
                <div class="col-md-3">
                  <h6 class="text-primary">üöÄ Benefits</h6>
                  <ul class="list-unstyled">
                    <li>‚Ä¢ Live monitoring</li>
                    <li>‚Ä¢ Instant updates</li>
                    <li>‚Ä¢ Better decisions</li>
                    <li>‚Ä¢ Real-time insights</li>
                    <li>‚Ä¢ Enhanced UX</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Load Comprehensive Calculations Engine -->
    <script src="../assets/js/metrics-engine/comprehensive-calculations.js"></script>

    <!-- Load Real-time Updater -->
    <script src="../assets/js/metrics-engine/real-time-updater.js"></script>

    <script>
      // Initialize Real-time Dashboard
      document.addEventListener("DOMContentLoaded", function () {
        console.log("Real-time Dashboard loaded");

        // Initialize with sample data
        initializeDashboard();

        // Set up status monitoring
        setupStatusMonitoring();
      });

      function initializeDashboard() {
        // Calculate initial metrics
        calculateAllComprehensiveMetrics();

        // Update status
        updateStatus("ƒê√£ kh·ªüi t·∫°o", "success");
      }

      function calculateAllComprehensiveMetrics() {
        try {
          // Sample data for all metrics
          const sampleData = {
            visitor: {
              totalVisitors: 1000,
              convertedVisitors: 152,
              returningVisitors: 685,
              sourceVisitors: 500,
              sourceConversions: 112,
              sourceRevenue: 500000000,
              sourceCost: 175000000,
            },
            sales: {
              saleTiep: 281,
              ptTiep: 221,
              inbodyMeasurements: 127,
              sales: [
                { leadDate: "2024-01-01", saleDate: "2024-01-15" },
                { leadDate: "2024-01-05", saleDate: "2024-01-18" },
                { leadDate: "2024-01-10", saleDate: "2024-01-22" },
              ],
              numberOfSales: 50,
              averageDealSize: 5000000,
              salesCycleLength: 12,
            },
            facility: {
              usedSpace: 750,
              totalSpace: 1000,
              usageTime: 600,
              availableTime: 800,
              usedLockers: 150,
              totalLockers: 220,
              peakHourRevenue: 225000000,
              totalRevenue: 500000000,
              offPeakUsage: 200,
              offPeakCapacity: 565,
            },
            member: {
              checkins: 2500,
              bookings: 800,
              ptSessions: 300,
              totalInteractions: 3600,
              daysActive: 30,
              channelSpend: 50000000,
              newMembers: 60,
              avgMonthlyRevenue: 1500000,
              avgMembershipDuration: 12,
              memberData: {
                daysSinceLastActivity: 5,
                paymentDelays: 0,
                engagementLevel: 0.8,
              },
            },
            financial: {
              totalRevenue: 500000000,
              totalSquareFootage: 1000,
              top20Revenue: 325000000,
              currentGrowthRate: 15,
              previousGrowthRate: 12,
              sourceSpend: 75000000,
              newMembers: 60,
              operationalCosts: 178500000,
              serviceRevenue: 300000000,
              serviceCosts: 173100000,
            },
            performance: {
              revenueGenerated: 500000000,
              staffHours: 2000,
              totalRevenue: 500000000,
              totalStaffHours: 2000,
              productiveHours: 1770,
              totalHours: 2000,
              ratings: [4, 5, 4, 5, 4, 3, 5, 4, 4, 5],
              completedServices: 923,
              totalServices: 1000,
              satisfactionScore: 4.2,
              completionRate: 92.3,
              efficiencyScore: 88.5,
            },
            digital: {
              websiteVisitors: 10000,
              websiteConversions: 320,
              likes: 1500,
              comments: 300,
              shares: 200,
              followers: 5000,
              digitalRevenue: 200000000,
              digitalCost: 52000000,
              totalSessions: 14000,
              activeUsers: 5000,
              featureUsage: 9420,
              totalSessions: 14000,
              totalUsers: 5000,
              returningUsers: 3945,
            },
            predictive: {
              historicalAverage: 1000,
              seasonalFactor: 1.1,
              growthRate: 15,
              currentRevenue: 500000000,
              growthRate: 15,
              timePeriod: 1,
              currentCapacity: 1500,
              utilizationRate: 80,
              growthFactor: 1.2,
              memberData: {
                daysSinceLastActivity: 7,
                paymentDelays: 1,
                engagementLevel: 0.6,
                satisfactionScore: 4,
              },
              revenueVolatility: 62500000,
              averageRevenue: 500000000,
              riskFactors: 8,
              totalFactors: 92,
            },
          };

          // Calculate all metrics
          const allMetrics =
            window.comprehensiveCalculations.calculateAllComprehensiveMetrics(
              sampleData
            );

          // Update UI with calculated metrics
          updateAllMetricsDisplay(allMetrics);

          console.log("All comprehensive metrics calculated:", allMetrics);
        } catch (error) {
          console.error("Error calculating comprehensive metrics:", error);
        }
      }

      function updateAllMetricsDisplay(metrics) {
        // Visitor metrics
        updateMetricElement(
          "visitorConversionRate",
          metrics.visitor.visitorConversionRate,
          "%"
        );
        updateMetricElement(
          "visitorRetentionRate",
          metrics.visitor.visitorRetentionRate,
          "%"
        );
        updateMetricElement(
          "sourceEffectivenessRate",
          metrics.visitor.sourceEffectivenessRate,
          "%"
        );
        updateMetricElement("sourceROI", metrics.visitor.sourceROI, "%");

        // Sales metrics
        updateMetricElement("saleTiepRate", metrics.sales.saleTiepRate, "%");
        updateMetricElement(
          "inbodyMeasurementRate",
          metrics.sales.inbodyMeasurementRate,
          "%"
        );
        updateMetricElement(
          "ptConversionRate",
          metrics.sales.ptConversionRate,
          "%"
        );
        updateMetricElement(
          "inbodyConversionRate",
          metrics.sales.inbodyConversionRate,
          "%"
        );
        updateMetricElement(
          "averageSalesCycle",
          metrics.sales.averageSalesCycle,
          "ng√†y"
        );
        updateMetricElement(
          "salesVelocity",
          metrics.sales.salesVelocity,
          "VNƒê/ng√†y"
        );

        // Facility metrics
        updateMetricElement(
          "floorSpaceUtilization",
          metrics.facility.floorSpaceUtilization,
          "%"
        );
        updateMetricElement(
          "equipmentUtilizationRate",
          metrics.facility.equipmentUtilizationRate,
          "%"
        );
        updateMetricElement(
          "lockerUtilization",
          metrics.facility.lockerUtilization,
          "%"
        );
        updateMetricElement(
          "peakHourRevenueConcentration",
          metrics.facility.peakHourRevenueConcentration,
          "%"
        );
        updateMetricElement(
          "offPeakUtilization",
          metrics.facility.offPeakUtilization,
          "%"
        );

        // Member analytics
        updateMetricElement(
          "memberActivityScore",
          metrics.member.memberActivityScore,
          "ƒëi·ªÉm"
        );
        updateMetricElement(
          "memberEngagementLevel",
          metrics.member.memberEngagementLevel,
          "%"
        );
        updateMetricElement(
          "memberAcquisitionCostByChannel",
          metrics.member.memberAcquisitionCostByChannel,
          "VNƒê"
        );
        updateMetricElement(
          "memberLifetimeValueBySegment",
          metrics.member.memberLifetimeValueBySegment,
          "VNƒê"
        );
        updateMetricElement(
          "memberChurnPredictionScore",
          metrics.member.memberChurnPredictionScore,
          ""
        );

        // Financial analytics
        updateMetricElement(
          "revenuePerSquareFoot",
          metrics.financial.revenuePerSquareFoot,
          "VNƒê/m¬≤"
        );
        updateMetricElement(
          "revenueConcentrationIndex",
          metrics.financial.revenueConcentrationIndex,
          "%"
        );
        updateMetricElement(
          "revenueGrowthAcceleration",
          metrics.financial.revenueGrowthAcceleration,
          "%"
        );
        updateMetricElement(
          "costPerAcquisitionBySource",
          metrics.financial.costPerAcquisitionBySource,
          "VNƒê"
        );
        updateMetricElement(
          "operationalCostRatio",
          metrics.financial.operationalCostRatio,
          "%"
        );
        updateMetricElement(
          "profitMarginByService",
          metrics.financial.profitMarginByService,
          "%"
        );

        // Performance metrics
        updateMetricElement(
          "staffProductivityIndex",
          metrics.performance.staffProductivityIndex,
          ""
        );
        updateMetricElement(
          "staffRevenuePerHour",
          metrics.performance.staffRevenuePerHour,
          "VNƒê/gi·ªù"
        );
        updateMetricElement(
          "staffUtilizationEfficiency",
          metrics.performance.staffUtilizationEfficiency,
          "%"
        );
        updateMetricElement(
          "serviceSatisfactionScore",
          metrics.performance.serviceSatisfactionScore,
          "/5.0"
        );
        updateMetricElement(
          "serviceCompletionRate",
          metrics.performance.serviceCompletionRate,
          "%"
        );
        updateMetricElement(
          "serviceQualityIndex",
          metrics.performance.serviceQualityIndex,
          ""
        );

        // Digital analytics
        updateMetricElement(
          "websiteConversionRate",
          metrics.digital.websiteConversionRate,
          "%"
        );
        updateMetricElement(
          "socialMediaEngagementRate",
          metrics.digital.socialMediaEngagementRate,
          "%"
        );
        updateMetricElement(
          "digitalMarketingROI",
          metrics.digital.digitalMarketingROI,
          "%"
        );
        updateMetricElement(
          "appUsageFrequency",
          metrics.digital.appUsageFrequency,
          "l·∫ßn/ng√†y"
        );
        updateMetricElement(
          "appFeatureUtilization",
          metrics.digital.appFeatureUtilization,
          "%"
        );
        updateMetricElement(
          "appRetentionRate",
          metrics.digital.appRetentionRate,
          "%"
        );

        // Predictive analytics
        updateMetricElement(
          "demandForecasting",
          metrics.predictive.demandForecasting,
          "l∆∞·ª£t"
        );
        updateMetricElement(
          "revenueForecasting",
          metrics.predictive.revenueForecasting,
          "VNƒê"
        );
        updateMetricElement(
          "capacityPlanning",
          metrics.predictive.capacityPlanning,
          "ch·ªó"
        );
        updateMetricElement(
          "churnRiskScore",
          metrics.predictive.churnRiskScore,
          ""
        );
        updateMetricElement(
          "revenueRiskAssessment",
          metrics.predictive.revenueRiskAssessment,
          "%"
        );
        updateMetricElement(
          "operationalRiskIndex",
          metrics.predictive.operationalRiskIndex,
          "%"
        );
      }

      function updateMetricElement(elementId, value, unit) {
        const element = document.getElementById(elementId);
        if (element && value !== undefined) {
          if (
            unit === "VNƒê" ||
            unit === "VNƒê/gi·ªù" ||
            unit === "VNƒê/ng√†y" ||
            unit === "VNƒê/m¬≤"
          ) {
            element.textContent =
              window.comprehensiveCalculations.formatCurrency(value) +
              (unit.includes("/") ? "/" + unit.split("/")[1] : "");
          } else if (unit === "%") {
            element.textContent =
              window.comprehensiveCalculations.formatPercentage(value);
          } else if (unit === "/5.0") {
            element.textContent = (value / 20).toFixed(1) + unit;
          } else {
            element.textContent =
              window.comprehensiveCalculations.formatNumber(value) +
              (unit ? " " + unit : "");
          }
        }
      }

      function setupStatusMonitoring() {
        // Monitor real-time updater status
        if (window.realTimeUpdater) {
          window.realTimeUpdater.onUpdate(function (metrics) {
            updateLastUpdateTime();
            updateStatus("ƒêang c·∫≠p nh·∫≠t...", "info");
          });
        }
      }

      function startRealTimeUpdates() {
        if (window.realTimeUpdater) {
          window.realTimeUpdater.start();
          updateStatus("ƒêang ch·∫°y", "success");
          document.getElementById("startBtn").disabled = true;
          document.getElementById("stopBtn").disabled = false;
        }
      }

      function stopRealTimeUpdates() {
        if (window.realTimeUpdater) {
          window.realTimeUpdater.stop();
          updateStatus("ƒê√£ d·ª´ng", "warning");
          document.getElementById("startBtn").disabled = false;
          document.getElementById("stopBtn").disabled = true;
        }
      }

      function manualRefresh() {
        updateStatus("ƒêang l√†m m·ªõi...", "info");
        calculateAllComprehensiveMetrics();
        updateLastUpdateTime();
        updateStatus("ƒê√£ l√†m m·ªõi", "success");
      }

      function changeUpdateInterval() {
        const interval = document.getElementById("updateInterval").value;
        if (window.realTimeUpdater) {
          window.realTimeUpdater.setUpdateInterval(parseInt(interval));
          updateStatus(`Interval: ${interval / 1000}s`, "info");
        }
      }

      function updateStatus(message, type) {
        const statusText = document.getElementById("statusText");
        const statusDetails = document.getElementById("statusDetails");
        const statusIndicator = document.getElementById("statusIndicator");

        statusText.textContent = message;
        statusDetails.textContent = message;
        statusDetails.className = `badge bg-${type}`;

        if (type === "success") {
          statusIndicator.className = "status-indicator status-online";
        } else if (type === "warning" || type === "info") {
          statusIndicator.className = "status-indicator status-online";
        } else {
          statusIndicator.className = "status-indicator status-offline";
        }
      }

      function updateLastUpdateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString("vi-VN");
        document.getElementById(
          "lastUpdateTime"
        ).textContent = `L·∫ßn c·∫≠p nh·∫≠t cu·ªëi: ${timeString}`;
      }
    </script>
  
    <!-- Universal Page Initializer -->
    <script src="../assets/js/shared/page-initializer.js"></script>
  </body>
</html>




