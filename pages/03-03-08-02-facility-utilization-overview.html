<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Facility Utilization Overview - Actiwell Reports</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
      <div class="container-fluid">
        <a class="navbar-brand" href="../index.html">
          <i class="fas fa-chart-line me-2"></i>Actiwell Reports
        </a>
        <div class="navbar-nav ms-auto">
          <a class="nav-link" href="../index.html">
            <i class="fas fa-arrow-left me-1"></i>Quay lại Dashboard
          </a>
        </div>
        <div class="navbar-nav">
          <span class="navbar-text text-white">
            <i class="fas fa-clock me-1"></i>
            <span id="currentTime"></span> |
            <span id="currentDate"></span>
          </span>
        </div>
      </div>
    </nav>

    <div class="container-fluid mt-4">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col-12">
          <h2 class="text-warning">
            <i class="fas fa-building me-2"></i>Facility Utilization Overview
          </h2>
          <p class="text-muted">
            Tổng quan về tỷ lệ sử dụng cơ sở vật chất và các chỉ số quan trọng
          </p>
        </div>
      </div>

      <!-- KPI Cards -->
      <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-warning text-white">
            <div class="card-body text-center">
              <i class="fas fa-percentage fa-2x mb-2"></i>
              <h6>Tỷ lệ lấp đầy tổng</h6>
              <h3>78.5%</h3>
              <small>trung bình hôm nay</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-primary text-white">
            <div class="card-body text-center">
              <i class="fas fa-users fa-2x mb-2"></i>
              <h6>Tổng lượt check-in</h6>
              <h3>2,259</h3>
              <small>lượt hôm nay</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-info text-white">
            <div class="card-body text-center">
              <i class="fas fa-building fa-2x mb-2"></i>
              <h6>Tổng dung lượng</h6>
              <h3>3,012</h3>
              <small>lượt/ngày</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-success text-white">
            <div class="card-body text-center">
              <i class="fas fa-chart-line fa-2x mb-2"></i>
              <h6>Tăng trưởng</h6>
              <h3>+12.1%</h3>
              <small>so với tuần trước</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Department Breakdown Cards -->
      <div class="row mb-4">
        <div class="col-12">
          <h4 class="text-secondary mb-3">
            <i class="fas fa-chart-pie me-2"></i>Phân tích theo bộ phận
          </h4>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div
            class="card bg-light clickable-card"
            onclick="openGymOccupancyDetail()"
            style="cursor: pointer"
          >
            <div class="card-body text-center">
              <i class="fas fa-dumbbell fa-2x text-primary mb-2"></i>
              <h6>Gym Occupancy</h6>
              <h4 class="text-primary">82.3%</h4>
              <small class="text-muted">1,245 lượt / 1,512 dung lượng</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div
            class="card bg-light clickable-card"
            onclick="openSwimmingCoachOccupancyDetail()"
            style="cursor: pointer"
          >
            <div class="card-body text-center">
              <i class="fas fa-swimming-pool fa-2x text-info mb-2"></i>
              <h6>Swimming Coach</h6>
              <h4 class="text-info">65.8%</h4>
              <small class="text-muted">658 lượt / 1,000 dung lượng</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div
            class="card bg-light clickable-card"
            onclick="openPilatesOccupancyDetail()"
            style="cursor: pointer"
          >
            <div class="card-body text-center">
              <i class="fas fa-spa fa-2x text-success mb-2"></i>
              <h6>Pilates Occupancy</h6>
              <h4 class="text-success">71.2%</h4>
              <small class="text-muted">356 lượt / 500 dung lượng</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-light">
            <div class="card-body text-center">
              <i class="fas fa-calculator fa-2x text-warning mb-2"></i>
              <h6>Tổng cộng</h6>
              <h4 class="text-warning">78.5%</h4>
              <small class="text-muted">2,259 lượt / 3,012 dung lượng</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Charts Section -->
      <div class="row mb-4">
        <div class="col-lg-6 mb-4">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-chart-pie me-2"></i>Phân bố sử dụng theo bộ
                phận
              </h5>
            </div>
            <div class="card-body">
              <div style="height: 400px">
                <canvas id="departmentChart"></canvas>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-6 mb-4">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-chart-line me-2"></i>Xu hướng sử dụng 7 ngày
                qua
              </h5>
            </div>
            <div class="card-body">
              <div style="height: 400px">
                <canvas id="weeklyTrendChart"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Summary Table -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-table me-2"></i>Tổng hợp sử dụng cơ sở theo bộ
                phận
              </h5>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table class="table table-striped table-hover">
                  <thead class="table-dark">
                    <tr>
                      <th>STT</th>
                      <th>Bộ phận</th>
                      <th>Dung lượng</th>
                      <th>Check-in hôm nay</th>
                      <th>Tỷ lệ sử dụng</th>
                      <th>Trạng thái</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>1</td>
                      <td><strong>Gym</strong></td>
                      <td><span class="badge bg-primary">1,512</span></td>
                      <td><span class="badge bg-success">1,245</span></td>
                      <td><span class="badge bg-info">82.3%</span></td>
                      <td><span class="badge bg-success">Tốt</span></td>
                    </tr>
                    <tr>
                      <td>2</td>
                      <td><strong>Swimming Coach</strong></td>
                      <td><span class="badge bg-primary">1,000</span></td>
                      <td><span class="badge bg-success">658</span></td>
                      <td><span class="badge bg-info">65.8%</span></td>
                      <td><span class="badge bg-warning">Trung bình</span></td>
                    </tr>
                    <tr>
                      <td>3</td>
                      <td><strong>Pilates</strong></td>
                      <td><span class="badge bg-primary">500</span></td>
                      <td><span class="badge bg-success">356</span></td>
                      <td><span class="badge bg-info">71.2%</span></td>
                      <td><span class="badge bg-success">Tốt</span></td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="2"><strong>TỔNG CỘNG</strong></td>
                      <td><strong class="text-primary">3,012</strong></td>
                      <td><strong class="text-success">2,259</strong></td>
                      <td><strong class="text-info">78.5%</strong></td>
                      <td><strong class="text-success">Tốt</strong></td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Update time and date
      function updateTime() {
        const now = new Date();
        const timeString = now.toLocaleTimeString("vi-VN", {
          hour: "2-digit",
          minute: "2-digit",
          second: "2-digit",
        });
        const dateString = now.toLocaleDateString("vi-VN");
        document.getElementById("currentTime").textContent = timeString;
        document.getElementById("currentDate").textContent = dateString;
      }

      // Update time every second
      setInterval(updateTime, 1000);
      updateTime();

      // Department Chart
      const departmentCtx = document
        .getElementById("departmentChart")
        .getContext("2d");
      new Chart(departmentCtx, {
        type: "doughnut",
        data: {
          labels: ["Gym", "Swimming Coach", "Pilates"],
          datasets: [
            {
              data: [1245, 658, 356],
              backgroundColor: [
                "rgba(54, 162, 235, 0.8)", // Gym - Blue
                "rgba(75, 192, 192, 0.8)", // Swimming Coach - Teal
                "rgba(40, 167, 69, 0.8)", // Pilates - Green
              ],
              borderColor: [
                "rgba(54, 162, 235, 1)", // Gym - Blue
                "rgba(75, 192, 192, 1)", // Swimming Coach - Teal
                "rgba(40, 167, 69, 1)", // Pilates - Green
              ],
              borderWidth: 2,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: "bottom",
            },
            tooltip: {
              callbacks: {
                label: function (context) {
                  const total = context.dataset.data.reduce((a, b) => a + b, 0);
                  const percentage = ((context.parsed / total) * 100).toFixed(
                    1
                  );
                  return (
                    context.label +
                    ": " +
                    context.parsed +
                    " lượt (" +
                    percentage +
                    "%)"
                  );
                },
              },
            },
          },
        },
      });

      // Weekly Trend Chart
      const weeklyCtx = document
        .getElementById("weeklyTrendChart")
        .getContext("2d");
      new Chart(weeklyCtx, {
        type: "line",
        data: {
          labels: ["T2", "T3", "T4", "T5", "T6", "T7", "CN"],
          datasets: [
            {
              label: "Tỷ lệ sử dụng tổng (%)",
              data: [75.2, 78.1, 81.3, 79.7, 82.2, 85.1, 78.5],
              borderColor: "rgba(255, 193, 7, 1)",
              backgroundColor: "rgba(255, 193, 7, 0.2)",
              tension: 0.4,
              fill: true,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
            },
          },
        },
      });

      // Navigation functions
      function openGymOccupancyDetail() {
        window.location.href = "gym-occupancy-detail.html";
      }

      function openSwimmingCoachOccupancyDetail() {
        window.location.href = "swimming-coach-occupancy-detail.html";
      }

      function openPilatesOccupancyDetail() {
        window.location.href = "pilates-occupancy-detail.html";
      }
    </script>
  
    <!-- SPA System -->
    <script src="../assets/js/spa/store.js"></script>
    <script src="../assets/js/spa/components.js"></script>
    <script src="../assets/js/spa/router.js"></script>
    <script src="../assets/js/spa/integration.js"></script>

    <!-- Universal Page Initializer -->
    <script src="../assets/js/shared/page-initializer.js"></script>
  </body>
</html>
