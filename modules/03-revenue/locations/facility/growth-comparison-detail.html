<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      Tăng trưởng So với Tháng trước - Chi tiết Tính toán - Actiwell Reports
    </title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-success">
      <div class="container-fluid">
        <a class="navbar-brand" href="../index.html">
          <i class="fas fa-arrow-left me-2"></i>
          <i class="fas fa-heartbeat me-2"></i>
          Actiwell Reports
        </a>
        <div class="navbar-nav ms-auto">
          <a class="nav-link" href="revenue-mtd-detail.html">
            <i class="fas fa-arrow-left me-1"></i>Quay lại MTD Detail
          </a>
        </div>
        <div class="navbar-nav">
          <span class="navbar-text text-white">
            <i class="fas fa-clock me-1"></i>
            <span id="currentTime"></span> |
            <span id="currentDate"></span>
          </span>
        </div>
      </div>
    </nav>

    <div class="container-fluid mt-4">
      <!-- Header -->
      <div class="row mb-4">
        <div class="col-12">
          <h2 class="text-success">
            <i class="fas fa-chart-line me-2"></i>Tăng trưởng So với Tháng trước
            - Chi tiết Tính toán
          </h2>
          <p class="text-muted">
            Phân tích chi tiết cách tính toán tỷ lệ tăng trưởng và so sánh doanh
            thu
          </p>
        </div>
      </div>

      <!-- Key Metrics -->
      <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-success text-white">
            <div class="card-body text-center">
              <i class="fas fa-percentage fa-2x mb-2"></i>
              <h6>Tỷ lệ tăng trưởng</h6>
              <h3 id="growthValue">+12.5%</h3>
              <small>so với tháng trước</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-primary text-white">
            <div class="card-body text-center">
              <i class="fas fa-arrow-up fa-2x mb-2"></i>
              <h6>Tăng trưởng tuyệt đối</h6>
              <h3>+205,000,000</h3>
              <small>VNĐ</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-info text-white">
            <div class="card-body text-center">
              <i class="fas fa-calendar-alt fa-2x mb-2"></i>
              <h6>Tháng hiện tại</h6>
              <h3>1,850,000,000</h3>
              <small>VNĐ</small>
            </div>
          </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
          <div class="card bg-warning text-white">
            <div class="card-body text-center">
              <i class="fas fa-calendar-minus fa-2x mb-2"></i>
              <h6>Tháng trước</h6>
              <h3>1,645,000,000</h3>
              <small>VNĐ</small>
            </div>
          </div>
        </div>
      </div>

      <!-- Calculation Formula -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-calculator me-2"></i>Công thức tính toán tăng
                trưởng
              </h5>
            </div>
            <div class="card-body">
              <div class="alert alert-success">
                <h6 class="mb-3">
                  <i class="fas fa-formula me-2"></i>Công thức chính:
                </h6>
                <div class="formula-box bg-light p-3 rounded">
                  <h5 class="text-success mb-3">
                    <strong
                      >Tỷ lệ tăng trưởng (%) = [(Doanh thu hiện tại - Doanh thu
                      trước) / Doanh thu trước] × 100</strong
                    >
                  </h5>
                  <div class="example-calculation">
                    <h6 class="text-primary mb-2">Ví dụ tính toán thực tế:</h6>
                    <div
                      class="calculation-example bg-white p-3 rounded border"
                    >
                      <h4 class="text-success mb-0">
                        <strong
                          >+12.5% = [(1,850,000,000 - 1,645,000,000) /
                          1,645,000,000] × 100</strong
                        >
                      </h4>
                      <small class="text-muted"
                        >Tăng trưởng tuyệt đối: +205,000,000 VNĐ</small
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Growth Comparison Chart -->
      <div class="row mb-4">
        <div class="col-lg-8 mb-4">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-chart-bar me-2"></i>So sánh doanh thu theo
                tháng
              </h5>
            </div>
            <div class="card-body">
              <canvas id="monthlyComparisonChart"></canvas>
            </div>
          </div>
        </div>
        <div class="col-lg-4 mb-4">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-chart-pie me-2"></i>Phân bố tăng trưởng
              </h5>
            </div>
            <div class="card-body">
              <canvas id="growthDistributionChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Detailed Comparison Table -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-table me-2"></i>So sánh chi tiết theo cơ sở
                <small class="text-muted ms-2">(Đơn vị: triệu VNĐ)</small>
              </h5>
            </div>
            <div class="card-body">
              <div class="table-responsive">
                <table
                  class="table table-striped table-hover table-sm"
                  style="font-size: 0.85rem"
                >
                  <thead class="table-dark">
                    <tr>
                      <th style="width: 20%">Cơ sở</th>
                      <th style="width: 15%">Tháng trước</th>
                      <th style="width: 15%">Tháng này</th>
                      <th style="width: 15%">Tăng trưởng</th>
                      <th style="width: 10%">Tỷ lệ</th>
                      <th style="width: 15%">Trạng thái</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td><strong>Tôn Thất Thuyết</strong></td>
                      <td>400M</td>
                      <td><span class="text-success">450M</span></td>
                      <td><span class="text-success">+50M</span></td>
                      <td><span class="badge bg-success">+12.5%</span></td>
                      <td><span class="badge bg-success">Tăng trưởng</span></td>
                    </tr>
                    <tr>
                      <td><strong>Huỳnh Thúc Kháng</strong></td>
                      <td>350M</td>
                      <td><span class="text-success">380M</span></td>
                      <td><span class="text-success">+30M</span></td>
                      <td><span class="badge bg-success">+8.6%</span></td>
                      <td><span class="badge bg-success">Tăng trưởng</span></td>
                    </tr>
                    <tr>
                      <td><strong>Giảng Võ</strong></td>
                      <td>300M</td>
                      <td><span class="text-success">320M</span></td>
                      <td><span class="text-success">+20M</span></td>
                      <td><span class="badge bg-success">+6.7%</span></td>
                      <td><span class="badge bg-success">Tăng trưởng</span></td>
                    </tr>
                    <tr>
                      <td><strong>Hào Nam</strong></td>
                      <td>280M</td>
                      <td><span class="text-success">290M</span></td>
                      <td><span class="text-success">+10M</span></td>
                      <td><span class="badge bg-success">+3.6%</span></td>
                      <td><span class="badge bg-success">Tăng trưởng</span></td>
                    </tr>
                    <tr>
                      <td><strong>Nguyễn Tuân</strong></td>
                      <td>200M</td>
                      <td><span class="text-success">200M</span></td>
                      <td><span class="text-muted">0</span></td>
                      <td><span class="badge bg-secondary">0%</span></td>
                      <td><span class="badge bg-warning">Ổn định</span></td>
                    </tr>
                    <tr>
                      <td><strong>Online & Dịch vụ</strong></td>
                      <td>115M</td>
                      <td><span class="text-success">210M</span></td>
                      <td><span class="text-success">+95M</span></td>
                      <td><span class="badge bg-success">+82.6%</span></td>
                      <td>
                        <span class="badge bg-success">Tăng trưởng mạnh</span>
                      </td>
                    </tr>
                    <tr class="table-success">
                      <td><strong>TỔNG CỘNG</strong></td>
                      <td><strong>1,645M</strong></td>
                      <td>
                        <strong class="text-success">1,850M</strong>
                      </td>
                      <td>
                        <strong class="text-success">+205M</strong>
                      </td>
                      <td><span class="badge bg-success">+12.5%</span></td>
                      <td><span class="badge bg-success">Tăng trưởng</span></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Growth Factors Analysis -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-search me-2"></i>Phân tích các yếu tố tăng
                trưởng
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-lg-6">
                  <h6 class="text-success">Yếu tố tích cực:</h6>
                  <ul>
                    <li>
                      <strong>Chương trình khuyến mãi mùa thu:</strong> +15%
                      doanh thu membership
                    </li>
                    <li>
                      <strong>Mở rộng dịch vụ online:</strong> +82.6% doanh thu
                      online
                    </li>
                    <li>
                      <strong>Chương trình PT Fitness mới:</strong> +20% doanh thu PT
                      sessions
                    </li>
                    <li>
                      <strong>Marketing hiệu quả:</strong> +25% khách hàng mới
                    </li>
                    <li>
                      <strong>Dịch vụ bổ sung:</strong> +30% doanh thu
                      spa/massage
                    </li>
                  </ul>
                </div>
                <div class="col-lg-6">
                  <h6 class="text-warning">Yếu tố cần cải thiện:</h6>
                  <ul>
                    <li>
                      <strong>Cơ sở Nguyễn Tuân:</strong> Không tăng trưởng (0%)
                    </li>
                    <li>
                      <strong>Group classes:</strong> Chỉ tăng +5% (thấp hơn mục
                      tiêu)
                    </li>
                    <li>
                      <strong>Retention rate:</strong> Giảm 2% so với tháng
                      trước
                    </li>
                    <li>
                      <strong>Peak hours:</strong> Chưa tối ưu hóa giờ cao điểm
                    </li>
                    <li>
                      <strong>Staff training:</strong> Cần cải thiện kỹ năng bán
                      hàng
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Historical Trend -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-chart-line me-2"></i>Xu hướng tăng trưởng 6
                tháng gần đây
              </h5>
            </div>
            <div class="card-body">
              <canvas id="historicalTrendChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Data Sources and Methodology -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="fas fa-database me-2"></i>Nguồn dữ liệu và phương pháp
                so sánh
              </h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-lg-6">
                  <h6 class="text-primary">Nguồn dữ liệu:</h6>
                  <ul>
                    <li><strong>Hệ thống POS:</strong> Doanh thu từng cơ sở</li>
                    <li>
                      <strong>CRM System:</strong> Lịch sử giao dịch khách hàng
                    </li>
                    <li>
                      <strong>Financial Reports:</strong> Báo cáo tài chính hàng
                      tháng
                    </li>
                    <li><strong>Bank Statements:</strong> Sao kê ngân hàng</li>
                  </ul>

                  <h6 class="text-success">Phương pháp so sánh:</h6>
                  <ul>
                    <li>So sánh cùng kỳ (1-22 tháng 9 vs 1-22 tháng 8)</li>
                    <li>Loại bỏ các giao dịch bất thường</li>
                    <li>Điều chỉnh theo yếu tố mùa vụ</li>
                    <li>Xác minh với bộ phận tài chính</li>
                  </ul>
                </div>
                <div class="col-lg-6">
                  <h6 class="text-info">Tiêu chí đánh giá:</h6>
                  <ul>
                    <li><strong>Tăng trưởng >10%:</strong> Xuất sắc</li>
                    <li><strong>Tăng trưởng 5-10%:</strong> Tốt</li>
                    <li><strong>Tăng trưởng 0-5%:</strong> Ổn định</li>
                    <li><strong>Tăng trưởng <0%:</strong> Cần cải thiện</li>
                  </ul>

                  <h6 class="text-warning">Lưu ý quan trọng:</h6>
                  <ul>
                    <li>Dữ liệu được cập nhật real-time</li>
                    <li>So sánh cùng số ngày trong tháng</li>
                    <li>Loại trừ các giao dịch đặc biệt</li>
                    <li>Xem xét yếu tố mùa vụ</li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../assets/js/realtime-clock.js"></script>
    <script>
      // Monthly Comparison Chart
      const monthlyComparisonCtx = document
        .getElementById("monthlyComparisonChart")
        .getContext("2d");
      new Chart(monthlyComparisonCtx, {
        type: "bar",
        data: {
          labels: ["Tháng 8/2025", "Tháng 9/2025"],
          datasets: [
            {
              label: "Doanh thu (VNĐ)",
              data: [1645000000, 1850000000],
              backgroundColor: ["#6c757d", "#198754"],
              borderWidth: 1,
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: "So sánh doanh thu tháng 8 vs tháng 9",
            },
          },
          scales: {
            y: {
              beginAtZero: true,
              ticks: {
                callback: function (value) {
                  return (value / 1000000000).toFixed(1) + "B";
                },
              },
            },
          },
        },
      });

      // Growth Distribution Chart
      const growthDistributionCtx = document
        .getElementById("growthDistributionChart")
        .getContext("2d");
      new Chart(growthDistributionCtx, {
        type: "doughnut",
        data: {
          labels: ["Tăng trưởng", "Cơ sở cũ"],
          datasets: [
            {
              data: [205000000, 1645000000],
              backgroundColor: ["#198754", "#e9ecef"],
              borderWidth: 2,
              borderColor: "#fff",
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: "Phân bố tăng trưởng",
            },
            legend: {
              position: "bottom",
            },
          },
        },
      });

      // Historical Trend Chart
      const historicalTrendCtx = document
        .getElementById("historicalTrendChart")
        .getContext("2d");
      new Chart(historicalTrendCtx, {
        type: "line",
        data: {
          labels: [
            "T4/2025",
            "T5/2025",
            "T6/2025",
            "T7/2025",
            "T8/2025",
            "T9/2025",
          ],
          datasets: [
            {
              label: "Doanh thu (VNĐ)",
              data: [
                1500000000, 1550000000, 1580000000, 1600000000, 1645000000,
                1850000000,
              ],
              borderColor: "#198754",
              backgroundColor: "rgba(25, 135, 84, 0.1)",
              tension: 0.4,
              fill: true,
            },
            {
              label: "Tăng trưởng (%)",
              data: [0, 3.3, 1.9, 1.3, 2.8, 12.5],
              borderColor: "#0d6efd",
              backgroundColor: "rgba(13, 110, 253, 0.1)",
              tension: 0.4,
              yAxisID: "y1",
            },
          ],
        },
        options: {
          responsive: true,
          plugins: {
            title: {
              display: true,
              text: "Xu hướng tăng trưởng 6 tháng gần đây",
            },
          },
          scales: {
            y: {
              type: "linear",
              display: true,
              position: "left",
              ticks: {
                callback: function (value) {
                  return (value / 1000000000).toFixed(1) + "B";
                },
              },
            },
            y1: {
              type: "linear",
              display: true,
              position: "right",
              ticks: {
                callback: function (value) {
                  return value + "%";
                },
              },
              grid: {
                drawOnChartArea: false,
              },
            },
          },
        },
      });
    </script>
    <!-- Filter Integration Script -->
    <script src="../assets/js/data-consistency.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/filter-handler.js"></script>
  
    <!-- SPA System -->
    <script src="../assets/js/spa/store.js"></script>
    <script src="../assets/js/spa/components.js"></script>
    <script src="../assets/js/spa/router.js"></script>
    <script src="../assets/js/spa/integration.js"></script>
</body>
</html>
